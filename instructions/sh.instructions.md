---
applyTo: "**/*.sh"
---
# Copilot Instruction for Shell Script

## 基本

- shbangは`bash`とする。
- 実行オプションの基本は`-euo pipefail`とする。

## 関数

- 原則として関数内に処理を記述する。
- エントリ関数はmainを利用する。
- mainでは必須の引数を`:?`で指定する。
- main関数の記述は最下部とする。
- 関数の呼び出しは下から上にする。

## 引数

- 関数の引数はローカル変数に代入して利用する。
- 引数`$1`などは`${}`で必ず展開する。
- 引数定義の次は改行をする。
- 環境変数はmainの引数として受け取り、直接利用しない。

## 変数

- 変数は関数内で定義し、ローカル変数`local`とする。
- ローカル変数は原則読み込み専用(`-r`指定)とする。
- 変数は`${}`で必ず展開する。
- 未定義の場合の処理など、変数展開を積極的に利用する。

## その他

- コマンドのオプションはロングオプションを利用する。
- ライブラリの場合
  - main関数は定義しない。
